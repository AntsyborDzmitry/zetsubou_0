define(['exports', 'module', './item-attributes-form-controller', './../../../../filters/convert-uom-filter', './../../../../filters/calculate-total-filter', './../../../../directives/ewf-validate/ewf-validate-attribute-directive', 'ewf'], function (exports, module, _itemAttributesFormController, _filtersConvertUomFilter, _filtersCalculateTotalFilter, _directivesEwfValidateEwfValidateAttributeDirective, _ewf) {
    'use strict';

    var _slicedToArray = (function () { function sliceIterator(arr, i) { var _arr = []; var _n = true; var _d = false; var _e = undefined; try { for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i['return']) _i['return'](); } finally { if (_d) throw _e; } } return _arr; } return function (arr, i) { if (Array.isArray(arr)) { return arr; } else if (Symbol.iterator in Object(arr)) { return sliceIterator(arr, i); } else { throw new TypeError('Invalid attempt to destructure non-iterable instance'); } }; })();

    module.exports = itemAttributesForm;

    function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }

    var _ItemAttributesFormController = _interopRequireDefault(_itemAttributesFormController);

    var _ewf2 = _interopRequireDefault(_ewf);

    _ewf2['default'].directive('itemAttributesForm', itemAttributesForm);

    function itemAttributesForm() {
        return {
            restrict: 'EA',
            controller: _ItemAttributesFormController['default'],
            controllerAs: 'itemAttrFormCtrl',
            template: '<div class=row><div class=col-8><h2 class=\"h2 margin-top-none\" nls=shipment.shipment_type_packages_item_attributes_title></h2></div><div class=col-4><a class=\"section-help__link right\" nls=shipment.package_details_help_me></a></div></div><div ewf-form=itemAttributesForm class=\"item-attributes-block product-details margin-bottom\"><div class=product-list><div class=checkbox><input type=checkbox class=checkbox__input id=estimateDuties ng-model=itemAttrFormCtrl.estimateDuties> <label for=estimateDuties class=label nls=shipment.shipment_type_packages_item_attributes_estimate_duties_checkbox></label></div><div class=\"product-item row\" ng-repeat=\"product in itemAttrFormCtrl.itemAttributesModel.productList\" ng-form=attributeItemForm ewf-form=ewfAttributeItemForm><div class=product-item__number>{{$index + 1}}</div><div class=\"col-11 margin-left-none\"><div class=form-row><div ng-class=\"itemAttrFormCtrl.estimateDuties ? \'col-7\' : \'col-9\'\"><div class=ewf-autocomplete><div class=\"field field_width_full field_with-mark\" ewf-field=description><label class=label nls=shipment.shipment_type_packages_item_attributes_description></label> <input type=text class=input autocomplete=off ng-model=product.description ng-focus=itemAttrFormCtrl.showProductList(product) ng-change=itemAttrFormCtrl.showProductList(product) ng-blur=itemAttrFormCtrl.hideProductList(product) nls=shipment.shipment_type_packages_item_attributes_description ewf-input=itemAttributes.description ewf-validate-required> <span class=validation-mark></span><div ewf-field-errors></div><button type=button class=\"btn btn_addon btn_animate\" ng-click=itemAttrFormCtrl.showProductCatalogPopup(product)><span class=btn__text nls=shipment.shipment_type_packages_item_attributes_product_catalog></span><i class=dhlicon-packages></i></button><ul class=ewf-autocomplete__list ng-if=product.isProductListVisible><li ng-mousedown=\"itemAttrFormCtrl.pickProductListGroup(product, group)\" ng-repeat=\"group in itemAttrFormCtrl.productList | filter : {description : product.description}\"><div>{{group.name}}</div><em>{{group.description}}</em></li></ul></div></div></div><div class=col-2><div class=\"field field_width_full field_with-mark\" ewf-field=scheduleB><label class=\"label nowrap\"><span nls=shipment.shipment_type_packages_item_attributes_schedule_b></span> <a class=info><div nls=shipment.shipment_type_packages_item_attributes_commodity_code_tooltip_schedule_b></div></a></label> <input type=text placeholder=000 class=input maxlength=18 ng-model=product.scheduleB ewf-input=itemAttributes.scheduleB ewf-validate-pattern={{itemAttrFormCtrl.PATTERNS.commodityCode}} ewf-validate-required> <span class=validation-mark></span><div ewf-field-errors></div><button type=button class=\"btn btn_addon\"><i class=dhlicon-search></i></button></div></div><div class=col-2 ng-show=itemAttrFormCtrl.estimateDuties><div class=\"field field_width_full field_with-mark\" ewf-field=commodityCode><label class=\"label nowrap\"><span nls=shipment.shipment_type_packages_item_attributes_commodity_code></span> <a class=info><div nls=shipment.shipment_type_packages_item_attributes_commodity_code_tooltip></div></a></label> <input type=text placeholder=000 class=input maxlength=18 ng-model=product.commodityCode ng-change=itemAttrFormCtrl.updateTaxesFromCommodityCode(product) ewf-input=itemAttributes.commodityCode ewf-validate-pattern={{itemAttrFormCtrl.PATTERNS.commodityCode}} ewf-validate-required> <span class=validation-mark></span><div ewf-field-errors></div><button type=button class=\"btn btn_addon\" ng-click=itemAttrFormCtrl.showCommoditiesCodeSearchPopup(product)><i class=dhlicon-search></i></button></div></div></div><div class=row><div class=col-1><div class=field ewf-field=quantity><label class=label nls=shipment.shipment_type_packages_item_attributes_quantity></label> <input type=text class=\"input input_width_tiny\" maxlength=4 ng-model=product.quantity ewf-input=itemAttributes.quantity ewf-validate-pattern={{itemAttrFormCtrl.PATTERNS.quantity}} ewf-validate-required> <span class=validation-mark></span><div class=msg-error_left ewf-field-errors></div></div></div><div class=col-2><div class=\"field field_with-mark field_width_full\" ewf-field=quantityUnits><label class=label nls=shipment.shipment_type_packages_item_attributes_units></label> <span class=select><select id=quantityUnit ng-options=\"unit for unit in itemAttrFormCtrl.quantityUnits\" ng-model=product.quantityUnits ewf-input=itemAttributes.quantityUnits ewf-validate-required></select><span class=validation-mark></span><div ewf-field-errors></div></span></div></div><div class=col-2><div class=field ewf-field=value><label class=label nls=shipment.shipment_type_packages_item_attributes_item_value></label> <input type=text class=\"input input_width_small\" maxlength=10 ng-model=product.value ewf-input=itemAttributes.value ewf-validate-pattern={{itemAttrFormCtrl.PATTERNS.dimension}} ewf-validate-required> <span class=validation-mark></span><div ewf-field-errors></div><select class=select-units ng-model=itemAttrFormCtrl.itemAttributesModel.currentCurrency ng-options=\"currency.type for currency in itemAttrFormCtrl.itemAttributesModel.currenciesList\"></select></div></div><div class=\"col-2 field\" ewf-field=netWeight><label class=label nls=shipment.shipment_type_packages_item_attributes_net_weight></label> <input type=text maxlength=5 class=\"input input_width_small\" ng-model=product.netWeight ewf-input=itemAttributes.netWeight ewf-validate-pattern={{itemAttrFormCtrl.PATTERNS.dimension}} ewf-validate-required> <span class=validation-mark></span><div ewf-field-errors></div>{{itemAttrFormCtrl.weightUnits()}}<div ng-if=itemAttrFormCtrl.isUnitsMismatched><small>{{product.netWeight | convertUomToOpposite : itemAttrFormCtrl.weightConvertionRate : itemAttrFormCtrl.userProfileCountryConversionPrecision}} {{itemAttrFormCtrl.weightUnits(true)}}</small></div></div><div class=\"col-2 field\" ng-if=shipmentTypeCtrl.isUserAuthorized ewf-field=grossWeight><label class=label nls=shipment.shipment_type_packages_item_attributes_gross_weight></label> <input type=text class=\"input input_width_small\" maxlength=5 ng-model=product.grossWeight ewf-input=itemAttributes.grossWeight ewf-validate-pattern={{itemAttrFormCtrl.PATTERNS.dimension}}><div ewf-field-errors></div>{{itemAttrFormCtrl.weightUnits()}}<div ng-if=itemAttrFormCtrl.isUnitsMismatched><small>{{product.grossWeight | convertUomToOpposite : itemAttrFormCtrl.weightConvertionRate : itemAttrFormCtrl.userProfileCountryConversionPrecision}} {{itemAttrFormCtrl.weightUnits(true)}}</small></div></div><div class=col-3><div class=ewf-autocomplete><div class=\"field field_width_full field_with-mark\" ewf-field=countriesList><label class=label nls=shipment.shipment_type_packages_item_attributes_country_title></label> <input type=text name=countryOfManufactureCode class=\"input input_width_full\" ng-model=product.countryName ng-focus=\"itemAttrFormCtrl.toggleShowCountriesList(product, true)\" ng-change=\"itemAttrFormCtrl.toggleShowCountriesList(product, true)\" ng-blur=\"itemAttrFormCtrl.toggleShowCountriesList(product, false)\" ewf-input=shipmentTypeForm.primaryReference ewf-validate-required> <span class=validation-mark></span><div ewf-field-errors></div><ul class=\"ewf-autocomplete__list ui-autocomplete ui-front ui-menu ui-widget ui-widget-conten\" ng-if=product.isCountriesListVisible><li class=\"ui-menu-item country-item\" ng-mousedown=\"itemAttrFormCtrl.pickCountry(product, country)\" ng-repeat=\"country in itemAttrFormCtrl.countriesList | filter : {name : product.countryName}\">{{ country.name }} <i ng-if=country.code2 class=\"right flag flag_{{country.code2}}\"></i></li></ul></div></div></div></div><div class=row><div class=msg-error ng-show=\"product.description === itemAttrFormCtrl.PROHIBITED_ITEM\"><span nls=shipment.shipment_type_packages_item_attributes_prohibited_item_error></span> <a nls=shipment.shipment_type_packages_item_attributes_prohibited_see_list></a></div></div></div><div class=col-1><div class=row ng-if=shipmentTypeCtrl.isUserAuthorized><div class=\"field field_width_full field_without-label\" ng-if=!product.id><button type=button class=\"btn btn_action tooltip right\" ng-disabled=!itemAttrFormCtrl.isSaveable(product) ng-click=itemAttrFormCtrl.handleSaveItemAttributesAction(product)><i class=dhlicon-save></i><b nls=shipment.shipment_type_packages_item_attributes_save></b> <span ng-if=itemAttrFormCtrl.isSaveable(product) nls=shipment.shipment_type_packages_item_attributes_save_tooltip></span> <span ng-if=!itemAttrFormCtrl.isSaveable(product) nls=shipment.shipment_type_packages_item_attributes_save_disabled_tooltip></span></button></div><div class=\"field field_width_full field_without-label\" ng-if=product.id><div class=right><label class=\"label tooltip\"><i class=dhlicon-check></i><label nls=shipment.shipment_type_packages_item_attributes_saved></label> <span class=align-center nls=shipment.shipment_type_packages_item_attributes_saved_tooltip></span></label></div></div></div><div class=row><div class=\"field field_width_full field_without-label\"><button type=button class=\"btn btn_action btn_width_half right\" ng-click=itemAttrFormCtrl.itemAttributesModel.copyItemAttributesRow(product)><i class=dhlicon-copy></i><span nls=shipment.shipment_type_packages_item_attributes_copy></span></button></div></div><div class=row ng-show=\"itemAttrFormCtrl.itemAttributesModel.productList.length > 1\"><div class=\"field field_width_full field_without-label\"><button type=button class=\"btn btn_action btn_width_half right\" ng-click=itemAttrFormCtrl.itemAttributesModel.deleteItemAttributesRow(product)><i class=dhlicon-remove></i><span nls=shipment.shipment_type_packages_item_attributes_remove></span></button></div></div></div></div><div class=form-row><p ng-show=itemAttrFormCtrl.isUnitsMismatched class=\"alert alert_info\" nls=shipment.shipment_type_packages_item_attributes_units_mismatch_recount_message></p><div><button type=button class=\"btn btn_small right\" ng-click=itemAttrFormCtrl.itemAttributesModel.addItemAttributesRow()><span nls=shipment.shipment_type_packages_item_attributes_add></span> <i class=dhlicon-add></i></button><p ng-show=!itemAttrFormCtrl.itemAttributesModel.isDutiesCountable() nls=shipment.shipment_type_packages_item_attributes_enter_commodity_code></p><p class=row ng-show=itemAttrFormCtrl.itemAttributesModel.isDutiesCountable()><span class=\"col-2 label\"><span nls=shipment.shipment_type_packages_item_attributes_tax></span>: {{itemAttrFormCtrl.itemAttributesModel.calculateTotalTax(\'taxPercent\')}}</span> <span class=\"col-2 label\"><span nls=shipment.shipment_type_packages_item_attributes_duty></span>: {{itemAttrFormCtrl.itemAttributesModel.calculateTotalTax(\'dutyPercent\')}}</span> <span class=col-4><b><span nls=shipment.shipment_type_packages_item_attributes_estimated_duties_taxes></span>: {{itemAttrFormCtrl.itemAttributesModel.calculateTotalTax([\'taxPercent\', \'dutyPercent\'])}}</b></span></p></div></div><div class=product-list__footer><div class=\"product-list__summary row\"><div class=col-3><div><span nls=shipment.shipment_type_packages_item_attributes_total_pieces></span>: <b>{{itemAttrFormCtrl.itemAttributesModel.calculateTotalQuantity()}}</b></div><div class=field ewf-field=numberOfPallets><span nls=shipment.shipment_type_packages_item_attributes_pallets_number></span>: <input type=text maxlength=4 name=numberOfPallets value=0 class=\"input input_small input_width_tiny\" ng-model=itemAttrFormCtrl.itemAttributesModel.numberOfPallets ewf-input=itemAttributes.numberOfPallets ewf-validate-pattern={{itemAttrFormCtrl.PATTERNS.quantity}}><div class=msg-error_left ewf-field-errors></div></div><div><span nls=shipment.shipment_type_packages_item_attributes_currency_code></span>: <b>{{itemAttrFormCtrl.itemAttributesModel.currentCurrency.type}}</b></div></div><div class=col-2><span nls=shipment.shipment_type_packages_item_attributes_total_net_weight></span>:<br><b>{{itemAttrFormCtrl.itemAttributesModel.calculateTotalWeight(\'netWeight\', \'totalNetWeight\')}} {{itemAttrFormCtrl.weightUnits()}}</b><div ng-if=itemAttrFormCtrl.isUnitsMismatched><b><small>{{itemAttrFormCtrl.itemAttributesModel.calculateTotalWeight(\'netWeight\') | convertUomToOpposite : itemAttrFormCtrl.weightConvertionRate : itemAttrFormCtrl.userProfileCountryConversionPrecision}} {{itemAttrFormCtrl.weightUnits(true)}}</small></b></div></div><div class=col-2><span nls=shipment.shipment_type_packages_item_attributes_total_gross_weight></span>:<br><b>{{itemAttrFormCtrl.itemAttributesModel.calculateTotalWeight(\'grossWeight\', \'totalGrossWeight\')}} {{itemAttrFormCtrl.weightUnits()}}</b><div ng-if=itemAttrFormCtrl.isUnitsMismatched><b><small>{{itemAttrFormCtrl.itemAttributesModel.calculateTotalWeight(\'grossWeight\') | convertUomToOpposite : itemAttrFormCtrl.weightConvertionRate : itemAttrFormCtrl.userProfileCountryConversionPrecision}} {{itemAttrFormCtrl.weightUnits(true)}}</small></b></div></div><div class=\"col-5 a-right\"><table class=right><tbody><tr><td class=\"nowrap margin-right\"><span nls=shipment.shipment_type_packages_item_attributes_shipment_value></span>:</td><td align=left><div class=\"margin-left fw-bold\">{{itemAttrFormCtrl.itemAttributesModel.calculateTotalShipmentValue()}}</div></td></tr><tr><td class=nowrap><span nls=shipment.shipment_type_packages_item_attributes_total_declared_value></span>:</td><td class=field ewf-field=totalDeclareValue><input type=text class=\"input input_small input_width_tiny\" maxlength=10 name=declaredValue ng-model=itemAttrFormCtrl.itemAttributesModel.totalDeclareValue ewf-input=itemAttributes.totalDeclareValue ewf-validate-pattern={{itemAttrFormCtrl.PATTERNS.dimension}}><select class=select-units ng-model=itemAttrFormCtrl.itemAttributesModel.currentCurrency ng-options=\"currency.type for currency in itemAttrFormCtrl.itemAttributesModel.currenciesList\"></select><div class=msg-error_left ewf-field-errors></div></td></tr><tr><td class=nowrap><span nls=shipment.shipment_type_packages_item_attributes_freight_cost></span> (<span nls=shipment.shipment_type_packages_item_attributes_if_paid_by_sender></span>):</td><td class=\"table__sum field\" ewf-field=freightCost><input type=text class=\"input input_small input_width_tiny\" maxlength=10 name=freightCost ng-model=itemAttrFormCtrl.itemAttributesModel.freightCost ewf-input=itemAttributes.freightCost ewf-validate-pattern={{itemAttrFormCtrl.PATTERNS.dimension}}><select class=select-units ng-model=itemAttrFormCtrl.itemAttributesModel.currentCurrency ng-options=\"currency.type for currency in itemAttrFormCtrl.itemAttributesModel.currenciesList\"></select><div class=msg-error_left ewf-field-errors></div></td></tr><tr><td class=nowrap><span nls=shipment.shipment_type_packages_item_attributes_insurance_cost></span> (<span nls=shipment.shipment_type_packages_item_attributes_if_paid_by_sender></span>):</td><td class=\"table__sum field\" ewf-field=insuranceCost><input type=text class=\"input input_small input_width_tiny\" maxlength=10 name=insuranceCost ng-model=itemAttrFormCtrl.itemAttributesModel.insuranceCost ewf-input=itemAttributes.insuranceCost ewf-validate-pattern={{itemAttrFormCtrl.PATTERNS.dimension}}><select class=select-units ng-model=itemAttrFormCtrl.itemAttributesModel.currentCurrency ng-options=\"currency.type for currency in itemAttrFormCtrl.itemAttributesModel.currenciesList\"></select><div class=msg-error_left ewf-field-errors></div></td></tr><tr><td class=nowrap><span nls=shipment.shipment_type_packages_item_attributes_other_charges></span>:</td><td class=\"table__sum field\" ewf-field=otherCharges><input type=text class=\"input input_small input_width_tiny\" maxlength=10 name=otherCharges ng-model=itemAttrFormCtrl.itemAttributesModel.otherCharges ewf-input=itemAttributes.otherCharges ewf-validate-pattern={{itemAttrFormCtrl.PATTERNS.dimension}}><select class=select-units ng-model=itemAttrFormCtrl.itemAttributesModel.currentCurrency ng-options=\"currency.type for currency in itemAttrFormCtrl.itemAttributesModel.currenciesList\"></select><div class=msg-error_left ewf-field-errors></div></td></tr></tbody></table></div></div></div></div></div><div class=\"field margin-bottom\" ng-if=\"itemAttrFormCtrl.itemAttributesModel.productList.length > 1\" ewf-field=invoiceDescription><div nls=shipment.shipment_type_summarize_shipment></div><input type=text class=\"input input_width_half\" name=invoiceDescription nls=shipment.shipment_type_summarize_shipment ng-model=itemAttrFormCtrl.itemAttributesModel.invoiceDescription ewf-input=itemAttributes.invoiceDescription ewf-validate-required> <span class=validation-mark></span><div class=msg-error_left ewf-field-errors></div></div><div id=modals class=visible ng-cloak ng-if=itemAttrFormCtrl.isProductCatalogVisible><div id=modal-bg ng-click=itemAttrFormCtrl.hideProductCatalogPopup()></div><div class=\"modal full-width visible\" id=modal_product-catalog><div><input type=text class=\"input input_small\" nls=shipment.shipment_type_packages_item_attributes_product_catalog_search ng-model=itemAttrFormCtrl.productCatalogSearchQuery ng-change=itemAttrFormCtrl.updateProductCatalog()> <a class=\"btn btn_small\" ng-click=itemAttrFormCtrl.updateProductCatalog()><i class=dhlicon-search></i></a><div ewf-grid class=data-table_zebra is-popup=true on-selection=\"itemAttrFormCtrl.pickProductCatalogRow($selection, $index)\" delete-url delete-param grid-data=itemAttrFormCtrl.productListFiltered visible-columns=itemAttrFormCtrl.productCatalogColumns sort-column=name></div></div><a class=\"x-button close-modal\" ng-click=itemAttrFormCtrl.hideProductCatalogPopup()></a></div></div>',
            require: ['itemAttributesForm', '?^itemAttributes'],
            link: {
                pre: function pre(scope, element, attributes, _ref) {
                    var _ref2 = _slicedToArray(_ref, 2);

                    var itemAttrFormCtrl = _ref2[0];
                    var itemAttrCtrl = _ref2[1];

                    itemAttrFormCtrl.init();
                    if (itemAttrCtrl) {
                        itemAttrCtrl.itemAttrFormCtrl = itemAttrFormCtrl;
                    }
                }
            }
        };
    }
});
//# sourceMappingURL=item-attributes-form-directive.js.map
