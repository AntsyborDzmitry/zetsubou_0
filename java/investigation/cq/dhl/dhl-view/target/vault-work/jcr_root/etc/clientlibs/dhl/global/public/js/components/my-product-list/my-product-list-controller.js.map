{"version":3,"sources":["components/my-product-list/my-product-list-controller.js"],"names":[],"mappings":"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","file":"components/my-product-list/my-product-list-controller.js","sourcesContent":["import './../../services/ewf-crud-service';\r\nimport './../../constants/system-settings-constants';\r\n\r\nMyProductListController.$inject = [\r\n    '$scope',\r\n    '$timeout',\r\n    'ewfCrudService',\r\n    'modalService',\r\n    'systemSettings'\r\n];\r\n\r\nexport default function MyProductListController(\r\n    $scope,\r\n    $timeout,\r\n    ewfCrudService,\r\n    modalService,\r\n    systemSettings) {\r\n    const vm = this;\r\n    const PRODUCT_URL = '/api/myprofile/customs/products';\r\n\r\n    const columnsToDisplay = [\r\n        {\r\n            alias: 'name',\r\n            title: 'shipment-settings.my_product_list_grid_column_name'\r\n        },\r\n        {\r\n            alias: 'description',\r\n            title: 'shipment-settings.my_product_list_grid_column_description'\r\n        },\r\n        {\r\n            alias: 'countryName',\r\n            title: 'shipment-settings.my_product_list_grid_column_commodity_code'\r\n        }\r\n    ];\r\n\r\n    Object.assign(vm, {\r\n        showUploadListDialogue,\r\n        alertTypes: {\r\n            catalogError: false,\r\n            catalogUpdated: false,\r\n            uploaded: false,\r\n            added: false,\r\n            updated: false,\r\n            deleted: false\r\n        },\r\n        gridData: [],\r\n        productList: [],\r\n        columnsToDisplay,\r\n        myProductListKey: '',\r\n        isFormVisible: false,\r\n\r\n        init,\r\n        editProduct,\r\n        onUpdate,\r\n        onAdd,\r\n        onCancel,\r\n        onCatalogUpdated,\r\n        onCatalogError,\r\n        isBulkDeleteButtonEnabled,\r\n        toggleNotificationAlert\r\n    });\r\n\r\n    function init() {\r\n        vm.gridCtrl.editCallback = editProduct;\r\n        getDataFromService();\r\n    }\r\n\r\n    function editProduct(key) {\r\n        showFormHideGrid();\r\n        vm.myProductListKey = key;\r\n    }\r\n\r\n    function onUpdate() {\r\n        showGridAndUpdate();\r\n        toggleNotificationAlert('updated');\r\n    }\r\n\r\n    function isBulkDeleteButtonEnabled() {\r\n        return !!vm.gridCtrl.getSelectedKeysOnCurrentPage().length;\r\n    }\r\n\r\n    function onAdd() {\r\n        showGridAndUpdate();\r\n        toggleNotificationAlert('added');\r\n    }\r\n\r\n    function onCancel() {\r\n        showGridHideFrom();\r\n    }\r\n\r\n    function onCatalogUpdated() {\r\n        getDataFromService();\r\n        toggleNotificationAlert('catalogUpdated');\r\n    }\r\n\r\n    function onCatalogError() {\r\n        toggleNotificationAlert('catalogError');\r\n    }\r\n\r\n    function getDataFromService() {\r\n        return ewfCrudService.getElementList(PRODUCT_URL)\r\n            .then((productList) => {\r\n                vm.productList = productList;\r\n                vm.gridData = vm.productList;\r\n                vm.gridCtrl.rebuildGrid(vm.gridData);\r\n            });\r\n    }\r\n\r\n    function toggleNotificationAlert(action) {\r\n        vm.alertTypes[action] = true;\r\n        $timeout(() => {\r\n            vm.alertTypes[action] = false;\r\n        }, systemSettings.showInformationHintTimeout);\r\n    }\r\n\r\n    function showGridAndUpdate() {\r\n        showGridHideFrom();\r\n        getDataFromService();\r\n    }\r\n\r\n    function showGridHideFrom() {\r\n        vm.isFormVisible = false;\r\n        vm.myProductListKey = '';\r\n    }\r\n\r\n    function showFormHideGrid() {\r\n        vm.isFormVisible = true;\r\n    }\r\n\r\n    function showUploadListDialogue() {\r\n        modalService.showDialog({\r\n            closeOnEsc: true,\r\n            scope: $scope,\r\n            windowClass: 'ngdialog-theme-default',\r\n            showClose: true,\r\n            template:'<div id=product_upload_list_container ewf-modal><product-upload-list class=\\\"modal half-width visible\\\" id=modal_uploadProductCatalog successful-handler=myProductListCtrl.onCatalogUpdated()><h3 class=h3 nls=shipment-settings.my_product_upload_list_upload_list_label></h3><hr class=\\\"hr margin-top-none\\\"><p><span nls=shipment-settings.my_product_upload_list_please_transfer_list_before_uploading_message></span><br><a href=/content/dhl/dam/dhl/product_catalog_template.csv nls=shipment-settings.my_product_upload_list_lnk_download_list_template></a></p><div class=\\\"alert alert_error\\\" id=listErrorAlert ng-if=productUploadListCtrl.alerts.showCatalogError><span ng-repeat=\\\"error in productUploadListCtrl.alerts.errors\\\">{{error | translate}}</span></div><form type=POST enctype=multipart/form-data action=/api/myprofile/customs/products/catalog/upload><ewf-file-uploader files-uploaded=\\\"productUploadListCtrl.onUploadSuccessful({key: key, size: fileSize, name: fileName})\\\" files-before-select=productUploadListCtrl.onBeforeSelectFiles() files-upload-error=productUploadListCtrl.onUploadError(errors)><div class=file-uploader><ul class=\\\"file-list file-list_downloaded\\\" ng-if=productUploadListCtrl.uploadedFiles().length><li class=file-list__item ng-repeat=\\\"fileItem in productUploadListCtrl.uploadedFiles()\\\"><div class=row><div class=col-9><div><a ng-href=fileItem.src ng-bind=fileItem.name></a></div><div ng-bind=fileItem.size></div></div><div class=\\\"col-3 a-right\\\"><a class=\\\"dhlicon-cancel btn-icon btn-icon_delete right\\\" data-aqa-id=delete_file ng-click=productUploadListCtrl.removeFile($index) nls=shipment-settings.my_product_upload_list_label_delete></a></div></div></li></ul><ul class=file-list ng-if=fileUploaderCtrl.canShowFileList()><li class=file-list__item ng-repeat=\\\"fileItem in fileUploaderCtrl.getFilesList()\\\" ng-bind=fileItem.name></li></ul><ewf-progress-bar class=progress_bar ng-if=fileUploaderCtrl.uploadStarted ewf-progress=fileUploaderCtrl.uploadProgress></ewf-progress-bar><br><div ng-if=fileUploaderCtrl.canShowFileList()><button type=button class=\\\"btn btn_action btn_regular\\\" data-aqa-id=cancel_upload ng-click=fileUploaderCtrl.clearFilesList() nls=shipment-settings.my_product_upload_list_btn_cancel></button> <button type=button class=\\\"btn btn_success btn_regular\\\" data-aqa-id=upload_file ng-click=fileUploaderCtrl.uploadFiles() nls=shipment-settings.my_product_upload_list_btn_upload></button></div><div class=field-wrapper ng-show=!fileUploaderCtrl.canShowFileList()><div class=\\\"btn btn_upload\\\"><input type=file name=customs_invoice_docs accept=.csv> <label nls=shipment-settings.my_product_upload_list_btn_browse_file data-aqa-id=brows_for_files></label></div><span class=note></span></div></div></ewf-file-uploader></form><a class=\\\"btn btn_success btn_small right margin-bottom\\\" data-aqa-id=add_list_of_product ng-if=productUploadListCtrl.uploadedFiles().length nls=shipment-settings.my_product_upload_list_btn_add_list_of_products ng-click=productUploadListCtrl.addListOfProducts()></a></product-upload-list></div>'\r\n        });\r\n    }\r\n}\r\n"],"sourceRoot":"/source/"}