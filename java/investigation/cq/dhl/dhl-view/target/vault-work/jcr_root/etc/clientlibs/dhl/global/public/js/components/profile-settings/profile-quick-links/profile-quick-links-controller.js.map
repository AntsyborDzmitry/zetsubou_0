{"version":3,"sources":["components/profile-settings/profile-quick-links/profile-quick-links-controller.js"],"names":[],"mappings":"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","file":"components/profile-settings/profile-quick-links/profile-quick-links-controller.js","sourcesContent":["import './profile-edit-quick-link-dialog-service';\r\nimport './../profile-settings-service';\r\nimport './../../../services/ewf-crud-service';\r\nimport './../../../constants/system-settings-constants';\r\nimport './../../../services/ewf-spinner-service';\r\n\r\nProfileQuickLinksController.$inject = [\r\n    '$timeout',\r\n    '$sce',\r\n    'ewfCrudService',\r\n    'profileEditQuickLinkDialogService',\r\n    'profileSettingsService',\r\n    'systemSettings',\r\n    'ewfSpinnerService'];\r\n\r\nexport default function ProfileQuickLinksController(\r\n    $timeout,\r\n    $sce,\r\n    ewfCrudService,\r\n    profileEditQuickLinkDialogService,\r\n    profileSettingsService,\r\n    systemSettings,\r\n    ewfSpinnerService) {\r\n    const vm = this;\r\n    const addUrl = '/api/myprofile/links/add';\r\n\r\n    Object.assign(vm, {\r\n        alertTypes: {\r\n            added: false,\r\n            updated: false,\r\n            deleted: false\r\n        },\r\n        columnsToDisplay: [\r\n            {alias: 'name', title: 'quick-links.name_column'},\r\n            {alias: 'link', title: 'quick-links.url_column'}\r\n        ],\r\n        quickLinkUrl: '',\r\n        quickLinkName: '',\r\n        gridData: undefined,\r\n\r\n        init,\r\n        addQuickLink,\r\n        editQuickLink,\r\n        getLinkHtml,\r\n        rebuildGrid,\r\n        toggleNotificationAlert,\r\n        updateQuickLink,\r\n        updateLinkHtml\r\n    });\r\n\r\n    function init() {\r\n        vm.gridCtrl.editCallback = editQuickLink;\r\n           rebuildGrid();\r\n    }\r\n\r\n    function rebuildGrid() {\r\n        const promise = profileSettingsService.getQuickLinks()\r\n            .then((data) => {\r\n                const parsedData = data.map((item) => {\r\n                    item.link = getLinkHtml(item.url);\r\n                    return item;\r\n                });\r\n                vm.gridCtrl.rebuildGrid(parsedData);\r\n            });\r\n        return ewfSpinnerService.applySpinner(promise);\r\n    }\r\n\r\n    function toggleNotificationAlert(action) {\r\n        vm.alertTypes[action] = true;\r\n        $timeout(() => {\r\n            vm.alertTypes[action] = false;\r\n        }, systemSettings.showInformationHintTimeout);\r\n    }\r\n\r\n    function addQuickLink(ngform, ewfForm) {\r\n        const isFormValid = ngform.$valid && vm.quickLinkName !== '' && vm.quickLinkUrl !== '';\r\n        if (isFormValid) {\r\n            const quickLink = {\r\n                name: vm.quickLinkName,\r\n                url: vm.quickLinkUrl\r\n            };\r\n            ewfCrudService.addElement(addUrl, quickLink)\r\n                .then(() => {\r\n                    vm.toggleNotificationAlert('added');\r\n                    vm.rebuildGrid();\r\n                }).catch(() => {\r\n                    ewfForm.ewfValidation();\r\n                });\r\n        }\r\n    }\r\n\r\n    function updateQuickLink(linkInfo) {\r\n        vm.updateLinkHtml(linkInfo);\r\n        vm.gridCtrl.updateElement(linkInfo)\r\n            .then(() => {\r\n                vm.toggleNotificationAlert('updated');\r\n            });\r\n    }\r\n\r\n    function editQuickLink(key) {\r\n        const quickLink = vm.gridData.find((elem) => elem.key === key);\r\n        profileEditQuickLinkDialogService.showSaveDialog(quickLink.name, quickLink.url)\r\n            .then((linkInfo) => {\r\n                linkInfo.key = key;\r\n                vm.updateQuickLink(linkInfo);\r\n            });\r\n    }\r\n\r\n    function getLinkHtml(string) {\r\n        return $sce.trustAsHtml(`<a href=\"${string}\" target=\"_blank\">${string}</a>`);\r\n    }\r\n\r\n    function updateLinkHtml(linkInfo) {\r\n        const findByKey = (el) => el.key === linkInfo.key;\r\n        let quickLink = vm.gridCtrl.attributes.gridData.find(findByKey);\r\n        quickLink.link = getLinkHtml(linkInfo.url);\r\n    }\r\n}\r\n"],"sourceRoot":"/source/"}