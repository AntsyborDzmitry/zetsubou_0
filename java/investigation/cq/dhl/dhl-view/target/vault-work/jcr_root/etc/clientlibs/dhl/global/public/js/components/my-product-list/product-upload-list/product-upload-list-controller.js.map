{"version":3,"sources":["components/my-product-list/product-upload-list/product-upload-list-controller.js"],"names":[],"mappings":";;;qBAewB,2BAA2B;;;;;;AAXnD,qBAAI,UAAU,CAAC,6BAA6B,EAAE,2BAA2B,CAAC,CAAC;;AAE3E,+BAA2B,CAAC,OAAO,GAAG,CAClC,QAAQ,EACR,QAAQ,EACR,UAAU,EACV,cAAc,EACd,gBAAgB,EAChB,gBAAgB,CACnB,CAAC;;AAEa,aAAS,2BAA2B,CAC/C,MAAM,EACN,MAAM,EACN,QAAQ,EACR,YAAY,EACZ,WAAW,EACX,cAAc,EAAE;;AAEhB,YAAM,EAAE,GAAG,IAAI,CAAC;AAChB,YAAM,aAAa,GAAG,EAAE,CAAC;AACzB,YAAM,qBAAqB,GAAG,8CAA8C,CAAC;;AAE7E,cAAM,CAAC,MAAM,CAAC,EAAE,EAAE;AACd,kBAAM,EAAE;AACJ,gCAAgB,EAAE,KAAK;aAC1B;;AAED,yBAAa,EAAb,aAAa;AACb,sBAAU,EAAV,UAAU;AACV,6BAAiB,EAAjB,iBAAiB;AACjB,8BAAkB,EAAlB,kBAAkB;AAClB,yBAAa,EAAb,aAAa;AACb,+BAAmB,EAAnB,mBAAmB;SACtB,CAAC,CAAC;;AAEH,iBAAS,aAAa,GAAG;AACrB,mBAAO,aAAa,CAAC;SACxB;;AAED,iBAAS,mBAAmB,GAAG;AAC3B,yBAAa,CAAC,MAAM,GAAG,CAAC,CAAC;SAC5B;;AAED,iBAAS,kBAAkB,CAAC,SAAS,EAAE;AACnC,yBAAa,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC;SACjC;;AAED,iBAAS,UAAU,CAAC,KAAK,EAAE;AACvB,yBAAa,CAAC,MAAM,CAAC,KAAK,EAAE,CAAC,CAAC,CAAC;SAClC;;AAED,iBAAS,aAAa,CAAC,MAAM,EAAE;AAC3B,wBAAY,CAAC,OAAO,CAAC,MAAM,EAAE,MAAM,EAAE,cAAc,CAAC,CAAC;AACrD,kBAAM,CAAC,MAAM,CAAC,EAAE,CAAC,MAAM,EAAE,EAAC,MAAM,EAAN,MAAM,EAAC,CAAC,CAAC;AACnC,mCAAuB,CAAC,kBAAkB,CAAC,CAAC;SAC/C;;AAED,iBAAS,iBAAiB,GAAG;AACzB,uBAAW,CAAC,aAAa,CAAC,qBAAqB,EAAE,aAAa,CAAC,CAAC,CAAC,CAAC,CAC7D,IAAI,CAAC,YAAM;AACR,sBAAM,CAAC,YAAY,CAAC,KAAK,EAAE,CAAC;AAC5B,4BAAY,CAAC,OAAO,CAAC,MAAM,EAAE,MAAM,EAAE,mBAAmB,CAAC,CAAC;aAC7D,CAAC,SACI,CAAC,UAAC,QAAQ,EAAK;AACjB,kBAAE,CAAC,aAAa,CAAC,QAAQ,CAAC,MAAM,CAAC,CAAC;aACrC,CAAC,CAAC;SAEV;;AAED,iBAAS,uBAAuB,CAAC,MAAM,EAAE;AACrC,cAAE,CAAC,MAAM,CAAC,MAAM,CAAC,GAAG,IAAI,CAAC;AACzB,oBAAQ,CAAC,YAAM;AACX,kBAAE,CAAC,MAAM,CAAC,MAAM,CAAC,GAAG,KAAK,CAAC;aAC7B,EAAE,cAAc,CAAC,0BAA0B,CAAC,CAAC;SACjD;KACJ","file":"components/my-product-list/product-upload-list/product-upload-list-controller.js","sourcesContent":["import ewf from 'ewf';\r\nimport './../../../services/ewf-crud-service';\r\nimport './../../../constants/system-settings-constants';\r\n\r\newf.controller('productUploadListController', ProductUploadListController);\r\n\r\nProductUploadListController.$inject = [\r\n    '$scope',\r\n    '$attrs',\r\n    '$timeout',\r\n    'attrsService',\r\n    'ewfCrudService',\r\n    'systemSettings'\r\n];\r\n\r\nexport default function ProductUploadListController(\r\n    $scope,\r\n    $attrs,\r\n    $timeout,\r\n    attrsService,\r\n    crudService,\r\n    systemSettings) {\r\n\r\n    const vm = this;\r\n    const filesInfoList = [];\r\n    const productSaveCatalogUrl = '/api/myprofile/customs/products/catalog/save';\r\n\r\n    Object.assign(vm, {\r\n        alerts: {\r\n            showCatalogError: false\r\n        },\r\n\r\n        uploadedFiles,\r\n        removeFile,\r\n        addListOfProducts,\r\n        onUploadSuccessful,\r\n        onUploadError,\r\n        onBeforeSelectFiles\r\n    });\r\n\r\n    function uploadedFiles() {\r\n        return filesInfoList;\r\n    }\r\n\r\n    function onBeforeSelectFiles() {\r\n        filesInfoList.length = 0;\r\n    }\r\n\r\n    function onUploadSuccessful(filesInfo) {\r\n        filesInfoList.push(filesInfo);\r\n    }\r\n\r\n    function removeFile(index) {\r\n        filesInfoList.splice(index, 1);\r\n    }\r\n\r\n    function onUploadError(errors) {\r\n        attrsService.trigger($scope, $attrs, 'errorHandler');\r\n        Object.assign(vm.alerts, {errors});\r\n        toggleNotificationAlert('showCatalogError');\r\n    }\r\n\r\n    function addListOfProducts() {\r\n        crudService.updateElement(productSaveCatalogUrl, filesInfoList[0])\r\n            .then(() => {\r\n                $scope.ewfModalCtrl.close();\r\n                attrsService.trigger($scope, $attrs, 'successfulHandler');\r\n            })\r\n            .catch((response) => {\r\n                vm.onUploadError(response.errors);\r\n            });\r\n\r\n    }\r\n\r\n    function toggleNotificationAlert(action) {\r\n        vm.alerts[action] = true;\r\n        $timeout(() => {\r\n            vm.alerts[action] = false;\r\n        }, systemSettings.showInformationHintTimeout);\r\n    }\r\n}\r\n"],"sourceRoot":"/source/"}