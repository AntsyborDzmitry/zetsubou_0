{"version":3,"sources":["components/shipment/enhanced-invoice/enhanced-invoice-controller.js"],"names":[],"mappings":";;;qBAcwB,yBAAyB;;AAPjD,6BAAyB,CAAC,OAAO,GAAG,CAAC,UAAU,EACV,gBAAgB,EAChB,iBAAiB,EACjB,cAAc,EACd,iBAAiB,EACjB,sBAAsB,CAAC,CAAC;;AAE9C,aAAS,yBAAyB,CAAC,QAAQ,EACR,cAAc,EACd,eAAe,EACf,YAAY,EACZ,eAAe,EACf,oBAAoB,EAAE;AACpE,YAAM,EAAE,GAAG,IAAI,CAAC;;AAEhB,cAAM,CAAC,MAAM,CAAC,EAAE,EAAE;AACd,gBAAI,EAAJ,IAAI;AACJ,0CAA8B,EAA9B,8BAA8B;AAC9B,wBAAY,EAAZ,YAAY;AACZ,2BAAe,EAAf,eAAe;AACf,2BAAe,EAAf,eAAe;AACf,qCAAyB,EAAzB,yBAAyB;AACzB,wCAA4B,EAA5B,4BAA4B;AAC5B,wBAAY,EAAZ,YAAY;;AAEZ,4BAAgB,EAAE,EAAE;SACvB,CAAC,CAAC;;AAEH,iBAAS,IAAI,GAAG;AACZ,cAAE,CAAC,OAAO,GAAG,oBAAoB,CAAC,IAAI,CAAC;AACnC,mCAAmB,EAAE,eAAe,CAAC,gCAAgC,EAAE;aAC1E,CAAC,CAAC;;AAEH,2BAAe,CAAC,sBAAsB,EAAE,CACnC,IAAI,CAAC,UAAC,aAAa,EAAK;AACrB,oCAAoB,CAAC,cAAc,CAAC,EAAC,aAAa,EAAb,aAAa,EAAC,CAAC,CAAC;AACrD,oCAAoB,CAAC,UAAU,EAAE,CAAC;aACrC,CAAC,CAAC;SACV;;AAED,iBAAS,8BAA8B,GAAG;AACtC,wBAAY,CAAC,UAAU,CAAC;AACpB,0BAAU,EAAE,IAAI;AAChB,2BAAW,EAAE,8CAA8C;AAC3D,wBAAQ,EAAC,qlDAAqlD;aACjmD,CAAC,CAAC;SACN;;AAED,iBAAS,YAAY,CAAC,IAAI,EAAE;AACxB,cAAE,CAAC,gBAAgB,GAAG,EAAE,CAAC;AACzB,cAAE,CAAC,OAAO,CAAC,cAAc,GAAG,IAAI,CAAC;SACpC;;AAED,iBAAS,eAAe,GAAG;AACvB,cAAE,CAAC,OAAO,CAAC,cAAc,GAAG,IAAI,CAAC;SACpC;;AAED,iBAAS,eAAe,CAAC,MAAM,EAAE;AAC7B,cAAE,CAAC,gBAAgB,GAAG,MAAM,IAAI,EAAE,CAAC;;AAEnC,gBAAI,CAAC,EAAE,CAAC,gBAAgB,CAAC,MAAM,EAAE;AAC7B,kBAAE,CAAC,gBAAgB,GAAG,CAAC,6BAA6B,CAAC,CAAC;aACzD;;AAED,oBAAQ,CAAC,YAAM;AACP,kBAAE,CAAC,gBAAgB,GAAG,EAAE,CAAC;aAC5B,EACD,cAAc,CAAC,0BAA0B,CAC5C,CAAC;SACL;;AAED,iBAAS,yBAAyB,CAAC,gBAAgB,EAAE;AACjD,mBAAO,CAAC,gBAAgB,CAAC,eAAe,EAAE,IAAI,CAAC,EAAE,CAAC,OAAO,CAAC,cAAc,CAAC;SAC5E;;AAED,iBAAS,4BAA4B,CAAC,gBAAgB,EAAE;AACpD,mBAAO,gBAAgB,CAAC,aAAa,IAAI,CAAC,CAAC,EAAE,CAAC,OAAO,CAAC,cAAc,CAAC;SACxE;;AAED,iBAAS,YAAY,GAAG;AACpB,cAAE,CAAC,OAAO,CAAC,UAAU,EAAE,CAAC;AACxB,cAAE,CAAC,OAAO,CAAC,cAAc,GAAG,IAAI,CAAC;AACjC,cAAE,CAAC,gBAAgB,GAAG,EAAE,CAAC;SAC5B;KACJ","file":"components/shipment/enhanced-invoice/enhanced-invoice-controller.js","sourcesContent":["import './enhanced-invoice-service';\r\nimport './../../../services/modal/modal-service';\r\nimport './enhanced-invoice-model';\r\nimport './../ewf-shipment-service';\r\nimport './../../../services/location-service';\r\nimport './../../../constants/system-settings-constants';\r\n\r\nEnhancedInvoiceController.$inject = ['$timeout',\r\n                                     'systemSettings',\r\n                                     'shipmentService',\r\n                                     'modalService',\r\n                                     'locationService',\r\n                                     'enhancedInvoiceModel'];\r\n\r\nexport default function EnhancedInvoiceController($timeout,\r\n                                                  systemSettings,\r\n                                                  shipmentService,\r\n                                                  modalService,\r\n                                                  locationService,\r\n                                                  enhancedInvoiceModel) {\r\n    const vm = this;\r\n\r\n    Object.assign(vm, {\r\n        init,\r\n        showSavedCustomsTemplatesPopup,\r\n        logoUploaded,\r\n        removeLogoImage,\r\n        logoUploadError,\r\n        isAttachLogoButtonVisible,\r\n        isAttachNewLogoButtonVisible,\r\n        clearInvoice,\r\n\r\n        logoUploadErrors: []\r\n    });\r\n\r\n    function init() {\r\n        vm.invoice = enhancedInvoiceModel.init({\r\n            involvedPartiesData: shipmentService.getInvolvedPartiesAddressDetails()\r\n        });\r\n\r\n        locationService.loadAvailableLocations()\r\n            .then((countriesList) => {\r\n                enhancedInvoiceModel.setInvoiceData({countriesList});\r\n                enhancedInvoiceModel.cacheModel();\r\n            });\r\n    }\r\n\r\n    function showSavedCustomsTemplatesPopup() {\r\n        modalService.showDialog({\r\n            closeOnEsc: true,\r\n            windowClass: 'ngdialog-theme-default ewf-modal_width_large',\r\n            template:'<div ewf-modal nls-title=shipment.shipment_type_enhanced_customs_invoice_saved_template_popup_title id=customsInvoiceTemplates><div class=\\\"dashboard__cards a-center\\\"><a class=\\\"dashboard__arrow dashboard__arrow_left\\\"><i class=dhlicon-carat-left></i></a><div class=dashboard__card><ul class=\\\"no-bullets list_slim margin-bottom\\\"><li><b>Saved Invoice Template Name 1</b></li><li>Commercial (no, there is no need to translate it)</li><li>Permanent (yes, it\\'s draft layout)</li><li>DAP</li></ul><ul class=\\\"no-bullets list_slim margin-bottom\\\"><li><b>Commodities</b></li><li>Hand-knit wool sweaters</li></ul><a class=\\\"btn btn_success btn_regular full-width\\\">Select Invoice</a></div><div class=dashboard__card><ul class=\\\"no-bullets list_slim margin-bottom\\\"><li><b>Saved Invoice Template Name 2</b></li><li>Commercial</li><li>Permanent</li><li>DAP</li></ul><ul class=\\\"no-bullets list_slim margin-bottom\\\"><li><b>Commodities</b></li><li>Widget 1</li></ul><a class=\\\"btn btn_success btn_regular full-width\\\">Select Invoice</a></div><div class=dashboard__card><ul class=\\\"no-bullets list_slim margin-bottom\\\"><li><b>Saved Invoice Template Name 3</b></li><li>Commercial</li><li>Permanent</li><li>DAP</li></ul><ul class=\\\"no-bullets list_slim margin-bottom\\\"><li><b>Commodities</b></li><li>Wool cap</li></ul><a class=\\\"btn btn_success btn_regular full-width\\\">Select Invoice</a></div><a class=\\\"dashboard__arrow dashboard__arrow_right\\\"><i class=dhlicon-carat-right></i></a></div><p class=\\\"a-right margin-bottom-none\\\"><a nls=shipment.shipment_type_enhanced_customs_invoice_saved_template_popup_all_title></a></p></div>'\r\n        });\r\n    }\r\n\r\n    function logoUploaded(logo) {\r\n        vm.logoUploadErrors = [];\r\n        vm.invoice.logoParameters = logo;\r\n    }\r\n\r\n    function removeLogoImage() {\r\n        vm.invoice.logoParameters = null;\r\n    }\r\n\r\n    function logoUploadError(errors) {\r\n        vm.logoUploadErrors = errors || [];\r\n\r\n        if (!vm.logoUploadErrors.length) {\r\n            vm.logoUploadErrors = ['errors.uploaded_file_failed'];\r\n        }\r\n\r\n        $timeout(() => {\r\n                vm.logoUploadErrors = [];\r\n            },\r\n            systemSettings.showInformationHintTimeout\r\n        );\r\n    }\r\n\r\n    function isAttachLogoButtonVisible(fileUploaderCtrl) {\r\n        return !fileUploaderCtrl.canShowFileList() && !vm.invoice.logoParameters;\r\n    }\r\n\r\n    function isAttachNewLogoButtonVisible(fileUploaderCtrl) {\r\n        return fileUploaderCtrl.filesUploaded || !!vm.invoice.logoParameters;\r\n    }\r\n\r\n    function clearInvoice() {\r\n        vm.invoice.resetModel();\r\n        vm.invoice.logoParameters = null;\r\n        vm.logoUploadErrors = [];\r\n    }\r\n}\r\n"],"sourceRoot":"/source/"}