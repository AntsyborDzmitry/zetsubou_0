{"version":3,"sources":["components/shipment/ewf-shipment-controller.js"],"names":[],"mappings":"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","file":"components/shipment/ewf-shipment-controller.js","sourcesContent":["import ewf from 'ewf';\r\nimport EwfShipmentStepBaseController from './ewf-shipment-step-base-controller';\r\nimport './ewf-shipment-flow-service';\r\n\r\nEwfShipmentController.$inject = ['$scope',\r\n                                 '$location',\r\n                                 'userService',\r\n                                 'nlsService',\r\n                                 'navigationService',\r\n                                 'shipmentFlowService',\r\n                                 'shipmentService'];\r\newf.controller('EwfShipmentController', EwfShipmentController);\r\n\r\nexport default function EwfShipmentController($scope,\r\n                                              $location,\r\n                                              userService,\r\n                                              nlsService,\r\n                                              navigationService,\r\n                                              shipmentFlowService,\r\n                                              shipmentService) {\r\n\r\n    const vm = this;\r\n    const steps = {};\r\n    const stepsIndex = [];\r\n    const initializedSteps = [];\r\n\r\n    let currentStep = null;\r\n    let shipmentId = null;\r\n    let mainFlowVisible = true;\r\n\r\n    Object.assign(vm, {\r\n        init,\r\n        addStep,\r\n        triggerMainFlowVisibility,\r\n        isMainFlowVisible\r\n    });\r\n\r\n    function init() {\r\n        shipmentFlowService.getStepsIncompleteData = getStepsIncompleteData;\r\n\r\n        subscribeForUrlChange();\r\n        goToFirstStep();\r\n        userService.whoAmI();\r\n        nlsService.getDictionary('shipment');\r\n\r\n        shipmentId = navigationService.getParamFromUrl('shipmentId');\r\n        if (shipmentId) {\r\n            shipmentService.getSavedShipmentData(shipmentId)\r\n                .then(triggerStepsLoadingShipmentData);\r\n        }\r\n    }\r\n\r\n    function subscribeForUrlChange() {\r\n        $scope.$on('$locationChangeSuccess', onLocationChange);\r\n    }\r\n\r\n    function onLocationChange() {\r\n        const stepName = $location.hash();\r\n        processStep(stepName);\r\n    }\r\n\r\n    function goToFirstStep() {\r\n        const stepName = stepsIndex[0];\r\n        if (stepName) {\r\n            $location.hash(stepName);\r\n        }\r\n    }\r\n\r\n    function goToNextStep() {\r\n        const nextStepIndex = stepsIndex.indexOf(currentStep.getName()) + 1;\r\n        const nextStepName = stepsIndex[nextStepIndex];\r\n        if (nextStepName) {\r\n            $location.hash(nextStepName);\r\n        }\r\n    }\r\n\r\n    function processStep(stepName) {\r\n        const stepCtrl = steps[stepName];\r\n        if (currentStep) {\r\n            currentStep.preview();\r\n        }\r\n        if (!initializedSteps.includes(stepName)) {\r\n            stepCtrl.init();\r\n            initializedSteps.push(stepName);\r\n        }\r\n        stepCtrl.edit();\r\n        currentStep = stepCtrl;\r\n    }\r\n\r\n    function addStep(stepCtrl) {\r\n        if (!(stepCtrl instanceof EwfShipmentStepBaseController)) {\r\n            throw new Error('stepCtrl should be an instance of EwfShipmentStepBaseController');\r\n        }\r\n        const stepName = stepCtrl.getName();\r\n\r\n        if (!stepsIndex.includes(stepName)) {\r\n            steps[stepName] = stepCtrl;\r\n            stepsIndex.push(stepName);\r\n\r\n            stepCtrl.setNextCallback(() => {\r\n                goToNextStep();\r\n            });\r\n            stepCtrl.setEditCallback(() => {\r\n                goToStep(stepName);\r\n            });\r\n        }\r\n    }\r\n\r\n    function goToStep(stepName) {\r\n        $location.hash(stepName);\r\n    }\r\n\r\n    function getStepsIncompleteData() {\r\n        Object.keys(steps).forEach((stepName) => {\r\n            steps[stepName].getCurrentIncompleteData();\r\n        });\r\n    }\r\n\r\n    function triggerStepsLoadingShipmentData(data) {\r\n        Object.keys(steps).forEach((stepName) => {\r\n            steps[stepName].loadShipmentData(data);\r\n        });\r\n    }\r\n\r\n    function triggerMainFlowVisibility() {\r\n        mainFlowVisible = !mainFlowVisible;\r\n    }\r\n\r\n    function isMainFlowVisible() {\r\n        return mainFlowVisible;\r\n    }\r\n\r\n}\r\n"],"sourceRoot":"/source/"}