{"version":3,"sources":["components/shipment/enhanced-invoice/enhanced-invoice-model.js"],"names":[],"mappings":"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","file":"components/shipment/enhanced-invoice/enhanced-invoice-model.js","sourcesContent":["import './../../../services/nls-service';\r\nimport './../shipment-type/item-attributes/item-attributes-model';\r\nimport ewf from 'ewf';\r\n\r\newf.service('enhancedInvoiceModel', EnhancedInvoiceModel);\r\n\r\nEnhancedInvoiceModel.$inject = ['$filter', 'nlsService', 'shipmentService', 'itemAttributesModel'];\r\n\r\nexport default function EnhancedInvoiceModel($filter, nlsService, shipmentService, itemAttributesModel) {\r\n    const NONE_ID = 'NONE';\r\n\r\n    const exporterIdTypes = [{\r\n        value: NONE_ID,\r\n        key: 'shipment.shipment_type_enhanced_customs_invoice_involved_parties_none'\r\n    }, {\r\n        value: 'DUNS',\r\n        key: 'shipment.shipment_type_enhanced_customs_invoice_involved_parties_duns_number'\r\n    }, {\r\n        value: 'SSN',\r\n        key: 'shipment.shipment_type_enhanced_customs_invoice_involved_parties_social_security_number'\r\n    }, {\r\n        value: 'EIN',\r\n        key: 'shipment.shipment_type_enhanced_customs_invoice_involved_parties_ein'\r\n    }, {\r\n        value: 'FEC',\r\n        key: 'shipment.shipment_type_enhanced_customs_invoice_involved_parties_fec'\r\n    }];\r\n\r\n    const paymentOptions = [{\r\n        value: '',\r\n        nls: 'shipment.shipment_type_enhanced_customs_terms_select_one'\r\n    }, {\r\n        value: 'ALTERNATE',\r\n        nls: 'shipment.shipment_type_enhanced_customs_terms_alternate_account'\r\n    }, {\r\n        value: 'CREDIT_CARD',\r\n        nls: 'shipment.shipment_type_enhanced_customs_terms_credit_card'\r\n    }, {\r\n        value: 'CASH',\r\n        nls: 'shipment.shipment_type_enhanced_customs_terms_cash'\r\n    }];\r\n\r\n    const requiresPedimentOptions = [{\r\n        value: 'yes',\r\n        nls: 'shipment.shipment_type_yes'\r\n    }, {\r\n        value: 'no',\r\n        nls: 'shipment.shipment_type_no'\r\n    }];\r\n\r\n    const invoiceTypes = {\r\n        COMMERCIAL: 'COMMERCIAL',\r\n        PROFORMA: 'PROFORMA'\r\n    };\r\n\r\n    let initialized = false;\r\n\r\n    Object.assign(this, {\r\n        invoiceType: null,\r\n        invoiceUserName: '',\r\n        paymentAccount: '',\r\n        exportIdType: '',\r\n        invoiceTypes,\r\n        paymentOptions,\r\n        requiresPedimentOptions,\r\n        country: {\r\n            code2: '',\r\n            name: ''\r\n        },\r\n        currentDate: '',\r\n        requiresPediment: null,\r\n        NONE_ID,\r\n        logoParameters: null,\r\n\r\n        contactDetails: {\r\n            phone: {}\r\n        },\r\n        addressDifferent: false,\r\n\r\n        init,\r\n        setInvoiceData,\r\n        toggleShowCountriesList,\r\n        pickCountry,\r\n        isCodeSelected,\r\n        cacheModel,\r\n        resetModel,\r\n\r\n        setContactDetails,\r\n        clearAddress\r\n    });\r\n\r\n    const cachedEnhancedInvoiceModel = {};\r\n    const cachedItemAttributesModel = {};\r\n\r\n    function init(params) {\r\n        if (initialized) {\r\n            return this;\r\n        }\r\n\r\n        this.currentDate = $filter('date')(new Date(), 'MM/dd/yyyy');\r\n        this.setInvoiceData(params);\r\n        this.exporterIdTypes = translateList(exporterIdTypes);\r\n        this.contactDetails = shipmentService.getReceiverContactDetails();\r\n\r\n        if (params && params.involvedPartiesData) {\r\n            this.invoiceUserName = params.involvedPartiesData.shipper.name;\r\n        }\r\n\r\n        initialized = true;\r\n\r\n        return this;\r\n    }\r\n\r\n    function setInvoiceData(params) {\r\n        Object.assign(this, params);\r\n    }\r\n\r\n    function translateList(list) {\r\n        return list.map((item) => {\r\n            item.title = nlsService.getTranslationSync(item.key);\r\n            return item;\r\n        });\r\n    }\r\n\r\n    function toggleShowCountriesList(state) {\r\n        this.isCountriesListVisible = state;\r\n    }\r\n\r\n    function pickCountry(country) {\r\n        this.country = {\r\n            code2: country.code2,\r\n            name: country.name\r\n        };\r\n\r\n        this.toggleShowCountriesList(false);\r\n    }\r\n\r\n    function isCodeSelected() {\r\n        return this.exportIdType !== this.NONE_ID && this.exportIdType !== '';\r\n    }\r\n\r\n    function cacheModel() {\r\n        angular.copy(itemAttributesModel, cachedItemAttributesModel);\r\n        if (angular.equals(cachedEnhancedInvoiceModel, {})) {\r\n            angular.copy(this, cachedEnhancedInvoiceModel);\r\n        }\r\n    }\r\n\r\n    function resetModel() {\r\n        angular.copy(cachedEnhancedInvoiceModel, this);\r\n        angular.copy(cachedItemAttributesModel, itemAttributesModel);\r\n    }\r\n\r\n    function setContactDetails(contact) {\r\n        Object.assign(this.contactDetails, {\r\n            name: contact.contactName,\r\n            company: contact.companyName,\r\n            email: contact.email,\r\n            nickName: contact.nickName,\r\n            vatTax: contact.toVatTax,\r\n            phone: {\r\n                phoneDetails: {\r\n                    phoneCountryCode: contact.phoneCountryCode,\r\n                    phoneExt: contact.phoneExt,\r\n                    phone: contact.phoneNumber,\r\n                    phoneType: contact.phoneType,\r\n                    fax: contact.fax,\r\n                    smsEnabled: contact.smsEnabled\r\n                }\r\n            },\r\n            addressDetails: {\r\n                addrLine1: contact.address,\r\n                addrLine2: contact.address2,\r\n                addrLine3: contact.address3,\r\n                countryName: contact.country,\r\n                countryCode: contact.countryCode,\r\n                zipOrPostCode: contact.zipOrPostCode,\r\n                city: contact.city,\r\n                stateOrProvince: contact.stateOrProvince,\r\n                residentialAddress: contact.residentialAddress,\r\n                key: contact.key\r\n            }\r\n        });\r\n    }\r\n\r\n    function clearAddress() {\r\n        this.contactDetails = {\r\n            phone: {\r\n                phoneDetails: {}\r\n            }\r\n        };\r\n    }\r\n}\r\n"],"sourceRoot":"/source/"}