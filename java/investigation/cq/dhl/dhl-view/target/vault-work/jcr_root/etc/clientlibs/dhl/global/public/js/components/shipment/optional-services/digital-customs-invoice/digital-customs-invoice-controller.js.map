{"version":3,"sources":["components/shipment/optional-services/digital-customs-invoice/digital-customs-invoice-controller.js"],"names":[],"mappings":"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","file":"components/shipment/optional-services/digital-customs-invoice/digital-customs-invoice-controller.js","sourcesContent":["import ewf from 'ewf';\r\nimport './../../../../services/ewf-crud-service';\r\nimport './../../../../services/modal/modal-service';\r\n\r\newf.controller('DigitalCustomsInvoiceController', DigitalCustomsInvoiceController);\r\n\r\nDigitalCustomsInvoiceController.$inject = ['$scope', 'ewfCrudService', 'modalService'];\r\n\r\nexport default function DigitalCustomsInvoiceController($scope, ewfCrudService, modalService) {\r\n    const vm = this;\r\n\r\n    let state = null;\r\n\r\n    const STATE = {\r\n        ENROLLED: 'enrolled',\r\n        DISMISSED: 'dismissed'\r\n    };\r\n\r\n    Object.assign(vm, {\r\n        dismiss,\r\n        enroll,\r\n        showEnrollmentDialog,\r\n        getFormAction,\r\n        handleCustomsInvoiceUploadSuccess,\r\n        handleCustomsInvoiceUploadError,\r\n        clearCustomsInvoiceUploadErrors,\r\n        deleteCustomsInvoice,\r\n        handleAdditionalDocumentsUploadSuccess,\r\n        handleAdditionalDocumentsUploadError,\r\n        clearAdditionalDocumentsUploadErrors,\r\n        deleteAdditionalDocument,\r\n        isEnrolled,\r\n        isDismissed\r\n    });\r\n\r\n    function dismiss() {\r\n        state = STATE.DISMISSED;\r\n    }\r\n\r\n    function enroll() {\r\n        state = STATE.ENROLLED;\r\n    }\r\n\r\n    function showEnrollmentDialog() {\r\n        const dialogPromise = modalService.showDialog({\r\n            template:'<div ewf-modal title=\\\"Digital Customs Invoice\\\"><hr><div class=section__content><b nls=shipment.digital_customs_invoice_popup_header></b> <textarea class=\\\"textarea textarea_width_full textarea_height_large\\\" nls=shipment.digital_customs_invoice_popup_terms_and_conditions_text>\\r\\n        </textarea> <label class=checkbox><input type=checkbox class=checkbox__input ng-model=agreedAndAccepted> <span class=label nls=shipment.digital_customs_invoice_popup_accept_t_and_c_checkbox></span></label><div class=right ng-if=agreedAndAccepted><button class=\\\"btn btn_success right\\\" ewf-modal-resolver nls=shipment.digital_customs_invoice_popup_enroll_button_label></button> <b class=block nls=shipment.digital_customs_invoice_popup_need_to_make_updates></b><div><span nls=shipment.digital_customs_invoice_popup_footer_left></span> <a href=# nls=shipment.digital_customs_invoice_popup_my_profile_and_settings_link></a> <span nls=shipment.digital_customs_invoice_popup_footer_right></span></div></div></div></div>'\r\n        }).result;\r\n        dialogPromise.then(vm.enroll);\r\n    }\r\n\r\n    function getFormAction() {\r\n        return `/api/shipment/customs-invoice/digital/${$scope.countryCode}`;\r\n    }\r\n\r\n    function deleteDocument(key) {\r\n        return ewfCrudService.deleteElement(`/api/shipment/customs-invoice/digital/${key}`);\r\n    }\r\n\r\n    function handleCustomsInvoiceUploadSuccess(files, onSuccessHandled) {\r\n        $scope.digitalCustomsInvoice.document = files[0];\r\n\r\n        onSuccessHandled();\r\n    }\r\n\r\n    function handleCustomsInvoiceUploadError(errors) {\r\n        vm.customsInvoiceUploadErrors = errors;\r\n    }\r\n\r\n    function clearCustomsInvoiceUploadErrors(onErrorsCleared) {\r\n        vm.customsInvoiceUploadErrors = null;\r\n        onErrorsCleared();\r\n    }\r\n\r\n    function deleteCustomsInvoice() {\r\n        const model = $scope.digitalCustomsInvoice;\r\n        deleteDocument(model.document.key)\r\n            .then(() => {\r\n                model.document = null;\r\n            });\r\n    }\r\n\r\n    function handleAdditionalDocumentsUploadSuccess(files, onSuccessHandled) {\r\n        $scope.digitalCustomsInvoice.additionalDocuments.push(...files);\r\n        onSuccessHandled();\r\n    }\r\n\r\n    function handleAdditionalDocumentsUploadError(errors) {\r\n        vm.additionalDocumentsUploadErrors = errors;\r\n    }\r\n\r\n    function clearAdditionalDocumentsUploadErrors(onErrorsCleared) {\r\n        vm.additionalDocumentsUploadErrors = null;\r\n        onErrorsCleared();\r\n    }\r\n\r\n    function deleteAdditionalDocument(documentIndex) {\r\n        const model = $scope.digitalCustomsInvoice;\r\n        deleteDocument(model.additionalDocuments[documentIndex].key)\r\n            .then(() => {\r\n                model.additionalDocuments.splice(documentIndex, 1);\r\n            });\r\n    }\r\n\r\n    function isDismissed() {\r\n        return state === STATE.DISMISSED;\r\n    }\r\n\r\n    function isEnrolled() {\r\n        return state === STATE.ENROLLED;\r\n    }\r\n}\r\n"],"sourceRoot":"/source/"}